[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Extending the causal inference toolkit for ecologists: A visualization method of indirect effects",
    "section": "",
    "text": "Allen Bush-Beaupré1, Simon Coroller-Chouraki1, Marc Bélisle1,2\n1Université de Sherbrooke, Département de biologie, Sherbrooke, Canada\n2Centre d’étude de la forêt (CÉF)\nAllen Bush-Beaupré: allen.bush-beaupre@usherbrooke.ca | ORCID: 0000-0001-6989-9278\nSimon Coroller-Chouraki: ORCID: 0000-0001-8721-3727\nMarc Bélisle: ORCID: 0000-0003-0657-6724\n\nWelcome to the webpage dedicated to visualizing indirect effects for a wide scope of use cases in causal and network analyses. Being ecologists, we have focused on applying the visualization method we developed to examples in ecology. The method can however be applied to all fields of research in which indirect effects are of interest. By leveraging commonly used software such as marginaleffects and ggplot2, our method can be easily integrated into most analysis workflows.\n\n\n\n\nFigure 1.(A) Directed acyclic graph of a simulated example of the direct effect of an exposure variable on an outcome variable and its indirect effect through a mediator. (B) Prediction of the direct effect of the exposure on the outcome. (C) Prediction of the direct effect of the exposure on the mediator. (D) Prediction of the direct effect of the mediator on the outcome. (E) Prediction of the indirect effect of the exposure on the outcome superimposed on the prediction of the direct effect of the mediator on the outcome.\n\n\n\nAbstract\nMuch ecological research focuses on how a given variable can affect another either directly or indirectly through the effect of one or more intervening variables in the context of causal inference and network analyses. Various methods to quantify the magnitude of these effects are available but are difficult to interpret in a meaningful way. We propose a method of visualizing indirect effects by means of plotting model predictions of an outcome in the presence of exposure and mediator variables. We demonstrate the method through simulations and apply them to a real-world example involving Tree Swallows (Tachycineta bicolor) and their obligatory hematophagous ectoparasites, Protocalliphora spp. bird blowflies. The simple procedure using commonplace software should prove instrumental to visualize and interpret relationships among variables involved in ecological mechanisms and can be seamlessly integrated to analysts’ workflows.\n\nThis is the link towards the preprint of our article describing the method on Biorxiv.\nThis is the link to access and download the data used in the case study.\n\n\n\nWe use simulations to display the method with a simple use case in the Simulations tab. In the Blowfly Case Study tab, we show how to use the visualization method in the case of real world data and models in which the predictor variables have been scaled. This adds a subtle layer of complexity to the procedure but the code should help overcome this. Although not displayed in the publication, we have collaborated with Kallan Crémel to implement the method in cases where there are multiple mediators and interactions involved. This case study involving Bighorn Sheep can be found here."
  },
  {
    "objectID": "kallan_case_study.html",
    "href": "kallan_case_study.html",
    "title": "Case Study - Effects of snow cover characteristics and reproduction on body mass in bighorn sheep (Ovis canadensis)",
    "section": "",
    "text": "Here, we display the use of the visualization method for indirect effects with a real-world example of the carry-over effects of snow cover characteristics on subsequent spring and automn mass of bighorn sheep on Ram mountain (Alberta, CAN). The original article by Crémel et al. can be found at LINK. This use case is more complex than the ones presented in the original article describing the method (LINK) as there is more than one mediator involved and in some cases, the exposure interacts with a mediator and in another case, the exposure interacts with a mediator and both mediators interact with one-another. We will display how the visualization method can be used to make such complex relationships more intuitive to interpret.\nThe full DAGs for the three analyses we will be working here can be found below:\nTo better understand the DAGs and relationships, readers are referred to the original publication."
  },
  {
    "objectID": "kallan_case_study.html#load-packages",
    "href": "kallan_case_study.html#load-packages",
    "title": "Case Study - Effects of snow cover characteristics and reproduction on body mass in bighorn sheep (Ovis canadensis)",
    "section": "Load packages",
    "text": "Load packages\n\nlibrary(tidyverse)\nlibrary(brms)\nlibrary(cmdstanr)\nlibrary(tidybayes)\nlibrary(ggpubr)\nlibrary(marginaleffects)\nlibrary(splines)\nlibrary(patchwork)"
  },
  {
    "objectID": "kallan_case_study.html#load-data-and-models",
    "href": "kallan_case_study.html#load-data-and-models",
    "title": "Case Study - Effects of snow cover characteristics and reproduction on body mass in bighorn sheep (Ovis canadensis)",
    "section": "Load data and models",
    "text": "Load data and models\n\ndata_all &lt;- readRDS(\"mass_loss_data_all_Kallan_Cremel.rds\")\n\n# Female data and model\n## data\nData_females_uns &lt;- data_all$Data_females_uns \n\n## Model\nMass_loss_female_repro_int &lt;- readRDS(\"Mass_loss_female_repro_int_uns_Kallan_Cremel.rds\")\n\n# Lamb data and model\n## data\nData_lambs_uns &lt;- data_all$Data_lambs_uns\n\n\n## Model\nMass_loss_lamb &lt;- readRDS(\"Mass_loss_lamb_uns_Kallan_Cremel.rds\")\n\n# Male data and model\n## data\n### Scaled (for model)\nData_male_scaled &lt;- data_all$Data_male_scaled\n### Unscaled (for unscaling predictions)\nData_males_uns &lt;- data_all$Data_males_uns\n\n## Model\nMass_loss_male_pop &lt;- readRDS(\"Mass_loss_male_pop_Kallan_Cremel.rds\")"
  },
  {
    "objectID": "kallan_case_study.html#spring-mass-snow-reproductive-status",
    "href": "kallan_case_study.html#spring-mass-snow-reproductive-status",
    "title": "Case Study - Effects of snow cover characteristics and reproduction on body mass in bighorn sheep (Ovis canadensis)",
    "section": "Spring mass ~ Snow * Reproductive status",
    "text": "Spring mass ~ Snow * Reproductive status\n\ncol_repro &lt;- c(\"Non-reproductive\" = \"#d95f02\", \"Reproductive\" = \"#2ca25f\")\n\np_smass_snow &lt;- predictions(Mass_loss_female_repro_int,\n                           newdata = datagrid(avg_snow_depth = seq(from = min(Data_females_uns$avg_snow_depth),\n                                                                    to = max(Data_females_uns$avg_snow_depth),\n                                                                    by = 1),\n                                               lead_repro = c(0,1)),\n                           re_formula = NA,       # Population-level predictions\n                           type = \"response\",     # epred\n                           resp = \"nextwtd12\") |&gt; # spring mass\n               get_draws(shape = \"rvar\") |&gt;       # convert to rvar\n               mutate(Reproduction_status = factor(lead_repro, \n                                      levels = c(0, 1), \n                                      labels = c(\"Non-reproductive\", \"Reproductive\"))) \n\nLoading required namespace: rstan\n\nplot_smass_snow &lt;- ggplot() +\n  stat_lineribbon(data = p_smass_snow, aes(x = avg_snow_depth, ydist = rvar, fill = Reproduction_status),\n                  .width = seq(0.5, 0.95, length.out = 20), \n                  alpha = 0.05, color = \"black\") +\n  guides(fill = guide_legend(override.aes = list(alpha = 1, fill = NA, color = col_repro))) +\n  scale_fill_manual(values = col_repro) +\n  labs(\n    x = \"Average snow depth (cm)\",\n    y = \"Spring mass (kg)\",\n    fill = \"Reproduction status (t+1)\"\n  ) +\n  theme_pubr() +\n  theme(legend.position = \"inside\",\n        legend.position.inside = c(0.2, 0.2))\n\nplot_smass_snow"
  },
  {
    "objectID": "kallan_case_study.html#autumn-mass-spring-mass-reproductive-status",
    "href": "kallan_case_study.html#autumn-mass-spring-mass-reproductive-status",
    "title": "Case Study - Effects of snow cover characteristics and reproduction on body mass in bighorn sheep (Ovis canadensis)",
    "section": "Autumn mass ~ Spring mass * Reproductive status",
    "text": "Autumn mass ~ Spring mass * Reproductive status\n\np_amass_smass &lt;- predictions(Mass_loss_female_repro_int,\n                           newdata = datagrid(next_wtd12 = seq(from = min(Data_females_uns$next_wtd12),\n                                                                    to = max(Data_females_uns$next_wtd12),\n                                                                    by = 1),\n                                               lead_repro = c(0,1)),\n                           re_formula = NA,         # Population-level predictions\n                           type = \"response\",       # epred\n                           resp = \"wtd114next\") |&gt;  # autumn mass\n               get_draws(shape = \"rvar\") |&gt;         # convert to rvar\n               mutate(Reproduction_status = factor(lead_repro, \n                                      levels = c(0, 1), \n                                      labels = c(\"Non-reproductive\", \"Reproductive\"))) \n\nplot_amass_smass &lt;- ggplot() +\n  stat_lineribbon(data = p_amass_smass, aes(x = next_wtd12, ydist = rvar, fill = Reproduction_status),\n                  .width = seq(0.5, 0.95, length.out = 20), \n                  alpha = 0.05, color = \"black\") +\n  scale_fill_manual(values = col_repro) +\n  guides(fill = guide_legend(override.aes = list(alpha = 1, fill = NA, color = col_repro))) +\n  labs(\n    x = \"Spring mass (kg)\",\n    y = \"Autumn mass (kg)\",\n    fill = \"Reproduction status (t+1)\"\n  ) +\n  theme_pubr() +\n  theme(legend.position = \"inside\",\n        legend.position.inside = c(0.2, 0.8))\n\nplot_amass_smass"
  },
  {
    "objectID": "kallan_case_study.html#indirect-effect-of-snow-on-autumn-mass",
    "href": "kallan_case_study.html#indirect-effect-of-snow-on-autumn-mass",
    "title": "Case Study - Effects of snow cover characteristics and reproduction on body mass in bighorn sheep (Ovis canadensis)",
    "section": "Indirect effect of snow on autumn mass",
    "text": "Indirect effect of snow on autumn mass\n\nPredictions\nWe want to predict autumn mass from the predicted values of spring mass as a function of snow depth and reproductive status\n\n# the estimate column of p_smass_snow is the median of the posterior distribution\n# Let's simplify the prediction object to work with after\np_smass_snow |&gt; \n  as_tibble() |&gt; \n  select(estimate, avg_snow_depth, lead_repro) |&gt;\n  rename(next_wtd12 = estimate) -&gt; spring_mass_pred\n\n# Custom prediction grid\ndatagrid(model = Mass_loss_female_repro_int,\n         next_wtd12 = spring_mass_pred$next_wtd12) |&gt;\n  # need to add lead_repro separately as grid_type = \"dataframe\" argument throws an error\n  select(-lead_repro) |&gt;      \n  left_join(spring_mass_pred |&gt; select(next_wtd12, lead_repro)) -&gt; f_snow_indirect_pred_grid\n\n# Predictions\np_ind_snow_smass &lt;- predictions(Mass_loss_female_repro_int,\n                           newdata = f_snow_indirect_pred_grid,\n                           re_formula = NA,         # Population-level predictions\n                           type = \"response\",       # epred\n                           resp = \"wtd114next\") |&gt;  # autumn mass\n                    mutate(Reproduction_status = factor(lead_repro, \n                                      levels = c(0, 1), \n                                      labels = c(\"Non-reproductive\", \"Reproductive\"))) |&gt;\n              # Add snow values from spring mass prediction grid\n                    select(-avg_snow_depth) |&gt;\n                    left_join(spring_mass_pred)\n\n\n\nplot\n\nCOLS &lt;- alpha(colorRampPalette(c(\"#d0ddd6\",\"#47a6ddb7\"))(30),0.8)\n\nplot_amass_smass + \n  geom_line(data = p_ind_snow_smass, aes(x = next_wtd12, y = estimate, color = avg_snow_depth, linewidth = avg_snow_depth, group = Reproduction_status), lineend = \"round\") +\n  scale_color_gradientn(colours = COLS, name = \"Avg Snow Depth\") +\n  guides(linewidth = \"none\") +\n  theme(legend.direction = \"horizontal\",\n        legend.position = \"bottom\")\n\n\n\n\n\n\n\n\nThe indirect effect is small compared to the direct effect so let’s zoom in a little\n\nplot_amass_smass + \n  geom_line(data = p_ind_snow_smass, aes(x = next_wtd12, y = estimate, color = avg_snow_depth, linewidth = avg_snow_depth, group = Reproduction_status), lineend = \"round\") +\n  scale_color_gradientn(colours = COLS, name = \"Avg Snow Depth\") +\n  guides(linewidth = \"none\") +\n  theme(legend.direction = \"horizontal\",\n        legend.position = \"bottom\") +\n  coord_cartesian(xlim = c(50, 60), ylim = c(60, 80))"
  },
  {
    "objectID": "kallan_case_study.html#spring-mass-snow-reproductive-status-1",
    "href": "kallan_case_study.html#spring-mass-snow-reproductive-status-1",
    "title": "Case Study - Effects of snow cover characteristics and reproduction on body mass in bighorn sheep (Ovis canadensis)",
    "section": "Spring mass ~ Snow * Reproductive status",
    "text": "Spring mass ~ Snow * Reproductive status\n\ncol_sex &lt;- c(\"Male\" = \"#d95f02\", \"Female\" = \"#2ca25f\")\n\np_smass_snow_lambs &lt;- predictions(Mass_loss_lamb,\n                           newdata = datagrid(avg_snow_depth = seq(from = min(Data_lambs_uns$avg_snow_depth),\n                                                                    to = max(Data_lambs_uns$avg_snow_depth),\n                                                                    by = 1),\n                                               Sex = c(\"Male\", \"Female\")),\n                           re_formula = NA,       # Population-level predictions\n                           type = \"response\",     # epred\n                           resp = \"nextwtd12\") |&gt; # spring mass\n               get_draws(shape = \"rvar\")          # convert to rvar\n\nplot_smass_snow_lambs &lt;- ggplot() +\n  stat_lineribbon(data = p_smass_snow_lambs, aes(x = avg_snow_depth, ydist = rvar, fill = Sex),\n                  .width = seq(0.5, 0.95, length.out = 20), \n                  alpha = 0.05, color = \"black\") +\n  guides(fill = guide_legend(override.aes = list(alpha = 1, fill = NA, color = col_sex))) +\n  scale_fill_manual(values = col_sex, labels = c(\"Male\", \"Female\")) +\n  labs(\n    x = \"Average snow depth (cm)\",\n    y = \"Spring mass (kg)\",\n    fill = \"Sex\"\n  ) +\n  theme_pubr() +\n  theme(legend.position = \"inside\",\n        legend.position.inside = c(0.2, 0.2))\n\nplot_smass_snow_lambs"
  },
  {
    "objectID": "kallan_case_study.html#autumn-mass-spring-mass-sex",
    "href": "kallan_case_study.html#autumn-mass-spring-mass-sex",
    "title": "Case Study - Effects of snow cover characteristics and reproduction on body mass in bighorn sheep (Ovis canadensis)",
    "section": "Autumn mass ~ Spring mass * Sex",
    "text": "Autumn mass ~ Spring mass * Sex\n\np_amass_smass_lambs &lt;- predictions(Mass_loss_lamb,\n                           newdata = datagrid(next_wtd12 = seq(from = min(Data_lambs_uns$next_wtd12),\n                                                                    to = max(Data_lambs_uns$next_wtd12),\n                                                                    by = 1),\n                                               Sex = c(\"Male\", \"Female\")),\n                           re_formula = NA,         # Population-level predictions\n                           type = \"response\",       # epred\n                           resp = \"wtd114next\") |&gt;  # autumn mass\n               get_draws(shape = \"rvar\")            # convert to rvar\n\nplot_amass_smass_lambs &lt;- ggplot() +\n  stat_lineribbon(data = p_amass_smass_lambs, aes(x = next_wtd12, ydist = rvar, fill = Sex),\n                  .width = seq(0.5, 0.95, length.out = 20), \n                  alpha = 0.05, color = \"black\") +\n  scale_fill_manual(values = col_sex, labels = c(\"Male\", \"Female\")) +\n  guides(fill = guide_legend(override.aes = list(alpha = 1, fill = NA, color = col_sex))) +\n  labs(\n    x = \"Spring mass (kg)\",\n    y = \"Autumn mass (kg)\",\n    fill = \"Sex\"\n  ) +\n  theme_pubr() +\n  theme(legend.position = \"inside\",\n        legend.position.inside = c(0.2, 0.8))\n\nplot_amass_smass_lambs"
  },
  {
    "objectID": "kallan_case_study.html#indirect-effect-of-snow-on-autumn-mass-1",
    "href": "kallan_case_study.html#indirect-effect-of-snow-on-autumn-mass-1",
    "title": "Case Study - Effects of snow cover characteristics and reproduction on body mass in bighorn sheep (Ovis canadensis)",
    "section": "Indirect effect of snow on autumn mass",
    "text": "Indirect effect of snow on autumn mass\n\nPredictions\nWe want to predict autumn mass from the predicted values of spring mass as a function of snow depth and Sex\n\n# the estimate column of p_smass_snow is the median of the posterior distribution\n# Let's simplify the prediction object to work with after\np_smass_snow_lambs |&gt; \n  as_tibble() |&gt; \n  select(estimate, avg_snow_depth, Sex) |&gt;\n  rename(next_wtd12 = estimate) -&gt; spring_mass_pred_lambs\n\n# Custom prediction grid\ndatagrid(model = Mass_loss_lamb,\n         next_wtd12 = spring_mass_pred_lambs$next_wtd12) |&gt;\n  # need to add Sex separately as grid_type = \"dataframe\" argument throws an errorr\n  select(-Sex) |&gt;      \n  left_join(spring_mass_pred_lambs |&gt; select(next_wtd12, Sex)) -&gt; f_snow_indirect_pred_grid_lambs\n\n# Predictions\np_ind_snow_smass_lambs &lt;- predictions(Mass_loss_lamb,\n                           newdata = f_snow_indirect_pred_grid_lambs,\n                           re_formula = NA,         # Population-level predictions\n                           type = \"response\",       # epred\n                           resp = \"wtd114next\") |&gt;  # autumn mass\n              # Add snow values from spring mass prediction grid\n                    select(-avg_snow_depth) |&gt;\n                    left_join(spring_mass_pred_lambs)\n\n\n\nplot\n\nCOLS &lt;- alpha(colorRampPalette(c(\"#d0ddd6\",\"#47a6ddb7\"))(30),0.8)\n\nplot_amass_smass_lambs + \n  geom_line(data = p_ind_snow_smass_lambs, aes(x = next_wtd12, y = estimate, color = avg_snow_depth, linewidth = avg_snow_depth, group = Sex), lineend = \"round\") +\n  scale_color_gradientn(colours = COLS, name = \"Avg Snow Depth\") +\n  guides(linewidth = \"none\") +\n  theme(legend.direction = \"horizontal\",\n        legend.position = \"bottom\")"
  },
  {
    "objectID": "kallan_case_study.html#spring-mass-snow-population-density",
    "href": "kallan_case_study.html#spring-mass-snow-population-density",
    "title": "Case Study - Effects of snow cover characteristics and reproduction on body mass in bighorn sheep (Ovis canadensis)",
    "section": "Spring mass ~ Snow * Population density",
    "text": "Spring mass ~ Snow * Population density\n\np_smass_snow_males &lt;- predictions(Mass_loss_male_pop,\n                           newdata = datagrid(median_density = seq(from = min(Data_male_scaled$median_density),\n                                                                    to = max(Data_male_scaled$median_density),\n                                                                    by = 0.1),\n                                               pop_den = c(-1, 0, 1)),  # -1 SD, average, +1 SD\n                           re_formula = NA,       # Population-level predictions\n                           type = \"response\",     # epred\n                           resp = \"nextwtd12\") |&gt; # spring mass\n               get_draws(shape = \"rvar\")          # convert to rvar\n\n# average and sd of raw data to unscale predictors\nsd_den &lt;- sd(Data_males_uns$median_density)\nm_den  &lt;- mean(Data_males_uns$median_density)\nsd_pop &lt;- sd(Data_males_uns$pop_den)\nm_pop  &lt;- mean(Data_males_uns$pop_den)\n\n# unscale\np_smass_snow_males &lt;- p_smass_snow_males |&gt;\n  mutate(median_density_uns = median_density * sd_den + m_den,\n         pop_den_uns = pop_den * sd_pop + m_pop) |&gt;\n  # add labels for plot\n  mutate(Pop_Density_Label = factor(\n      paste0(round(pop_den_uns, 0)), \n      levels = unique(paste0(round(pop_den_uns, 0))) \n    )\n  )\n\n\nplot_smass_snow_males &lt;- ggplot() +\n  stat_lineribbon(data = p_smass_snow_males, aes(x = median_density_uns, ydist = rvar, fill = Pop_Density_Label),\n                  .width = seq(0.5, 0.95, length.out = 20), \n                  alpha = 0.05, color = \"black\") +\n  guides(fill = guide_legend(override.aes = list(alpha = 1, fill = NA, color = c(\"#1b9e77\", \"#d95f02\", \"#7570b3\")))) +\n  scale_fill_manual(values = c(\"#1b9e77\", \"#d95f02\", \"#7570b3\")) +\n  labs(\n    x = expression(\"Median snow density \" (kg/m^3)), \n    y = \"Spring mass (kg)\",\n    fill  = \"Population density\" ~ (ind),\n  )  +\n  theme_pubr() +\n  theme(legend.position = \"inside\",\n        legend.position.inside = c(0.3, 0.7))\n\nplot_smass_snow_males"
  },
  {
    "objectID": "kallan_case_study.html#autumn-mass-spring-mass",
    "href": "kallan_case_study.html#autumn-mass-spring-mass",
    "title": "Case Study - Effects of snow cover characteristics and reproduction on body mass in bighorn sheep (Ovis canadensis)",
    "section": "Autumn mass ~ Spring mass",
    "text": "Autumn mass ~ Spring mass\nThere is a little particularity here. To make the SEM work in brms, Kallan scaled spring mass (next_wtd12) in the model formula rather than in the dataset. We don`t need to scale or unscale spring mass for the predictions.\n\np_amass_smass_males &lt;- predictions(Mass_loss_male_pop,\n                           newdata = datagrid(next_wtd12 = seq(from = min(Data_male_scaled$next_wtd12),\n                                                                    to = max(Data_male_scaled$next_wtd12),\n                                                                    by = 1)),\n                           re_formula = NA,         # Population-level predictions\n                           type = \"response\",       # epred\n                           resp = \"wtd114next\") |&gt;  # autumn mass\n               get_draws(shape = \"rvar\")            # convert to rvar\n\nplot_amass_smass_males &lt;- ggplot() +\n  stat_lineribbon(data = p_amass_smass_males, aes(x = next_wtd12, ydist = rvar),\n                  .width = seq(0.5, 0.95, length.out = 20), \n                  alpha = 0.05, color = \"black\", fill = \"grey67\") +\n  labs(\n    x = \"Spring mass (kg)\", \n    y = \"Autumn mass (kg)\"\n  )  +\n  theme_pubr()\n\nplot_amass_smass_males"
  },
  {
    "objectID": "kallan_case_study.html#indirect-effect-of-snow-on-autumn-mass-population-density",
    "href": "kallan_case_study.html#indirect-effect-of-snow-on-autumn-mass-population-density",
    "title": "Case Study - Effects of snow cover characteristics and reproduction on body mass in bighorn sheep (Ovis canadensis)",
    "section": "Indirect effect of snow on autumn mass | population density",
    "text": "Indirect effect of snow on autumn mass | population density\nThis visualization is a bit tricky as the mediator (spring mass) does not interact with another variable for its effect on the outcome (autumn mass). However, the exposure (snow density) interacts with another exposure (population density) on the mediator (spring mass) and has no direct effect on the outcome (autumn mass).\n\np_smass_snow_males |&gt; \n  as_tibble() |&gt; \n  select(estimate, Pop_Density_Label, median_density_uns) |&gt;\n  rename(next_wtd12 = estimate) -&gt; spring_mass_pred_males\n\n# Custom prediction grid\ndatagrid(model = Mass_loss_male_pop,\n         next_wtd12 = spring_mass_pred_males$next_wtd12) |&gt;\n  # need to add other columns separately as grid_type = \"dataframe\" argument throws an error     \n  left_join(spring_mass_pred_males |&gt; select(next_wtd12, Pop_Density_Label, median_density_uns)) -&gt; f_snow_indirect_pred_grid_males\n\nJoining with `by = join_by(next_wtd12)`\n\np_ind_snow_smass_males &lt;- predictions(Mass_loss_male_pop,\n                           newdata = f_snow_indirect_pred_grid_males,\n                           re_formula = NA,              # Population-level predictions\n                           type = \"response\",            # epred\n                           resp = \"wtd114next\") |&gt;       # autumn mass\n                           select(estimate, next_wtd12, Pop_Density_Label, median_density_uns)\n\nplot_ind_snow_males &lt;- ggplot() +\n  geom_line(data = p_ind_snow_smass_males, aes(x = next_wtd12, y = estimate, color = median_density_uns, linewidth = median_density_uns), lineend = \"round\") +\n  scale_color_gradientn(colours = COLS, name = \"Med Snow Density\") +\n  guides(linewidth = \"none\") +\n  facet_wrap(~ Pop_Density_Label) +\n  theme(legend.direction = \"horizontal\",\n        legend.position = \"bottom\") +\n  labs(\n    x = \"Spring mass (kg)\", \n    y = \"Autumn mass (kg)\"\n  )  +\n  theme_pubr()\n\nplot_ind_snow_males\n\n\n\n\n\n\n\n\nNow, we combine all plots\n\n(plot_smass_snow_males + plot_amass_smass_males) / plot_ind_snow_males"
  }
]